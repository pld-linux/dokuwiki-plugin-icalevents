Only in /usr/share/dokuwiki/lib/plugins/iCalEvents/: .syntax.php.swo
Only in /usr/share/dokuwiki/lib/plugins/iCalEvents/: .syntax.php.swp
Only in /usr/share/dokuwiki/lib/plugins/iCalEvents/conf: default.php~
Only in .: iCalEvents
Only in ./lang: de
diff -ur -x .svn -x .git -x .bzr -x CVS ./syntax.php /usr/share/dokuwiki/lib/plugins/iCalEvents/syntax.php
--- ./syntax.php	2011-05-24 07:10:51.275958659 +0300
+++ /usr/share/dokuwiki/lib/plugins/iCalEvents/syntax.php	2011-05-23 12:38:52.386695372 +0300
@@ -88,17 +88,18 @@
       }
 
       $showEndDates = !empty($params['showEndDates']);
+      $showCurrentWeek = !empty($params['showCurrentWeek']);
       
-      #echo "url=$icsURL flags=$flagStr; from = $from;    previewSec = $previewSec; dateFormat=$dateFormat;<br/>";
+      #echo "url=$icsURL flags=$flagStr; from = $from;    previewSec = $previewSec; dateFormat=$dateFormat; showCurrentWeek=$showCurrentWeek<br/>";
       
-      return array($icsURL, $from, $previewSec, $dateFormat, $showEndDates); 
+      return array($icsURL, $from, $previewSec, $dateFormat, $showEndDates, $showCurrentWeek);
     }
     
     /**
      * loads the ics file via HTTP, parses it and renders an HTML table.
      */
     function render($mode, &$renderer, $data) {
-      list($url, $from, $previewSec, $dateFormat, $showEndDates) = $data;
+      list($url, $from, $previewSec, $dateFormat, $showEndDates, $showCurrentWeek) = $data;
       $ret = '';
       if($mode == 'xhtml'){
 	      # parse the ICS file
@@ -113,10 +114,16 @@
                   '<th>'.$this->getLang('what').'</th>'.
                   '<th>'.$this->getLang('description').'</th>'.
                   '<th>'.$this->getLang('where').'</th>'.
                   '</tr>'.NL;
+          $weekStart = strtotime("0 week ago 12:00");
+          $weekEnd = strtotime("1 weeks 12:00");
           foreach ($entries as $entry) {
             $rowCount++;
-            $ret .= '<tr>';
+            $ret .= '<tr';
+            if ($showCurrentWeek && ($entry['startunixdate'] >= $weekStart && $entry['endunixdate'] <= $weekEnd)) {
+                $ret .= ' style="background-color: red !important"';
+            }
+            $ret .= '>';
 			if ($showEndDates || $this->getConf('showEndDates')) {
 				$ret .= '<td>'.$entry['startdate'].' - '.$entry['enddate'].'</td>';
 			} else {
